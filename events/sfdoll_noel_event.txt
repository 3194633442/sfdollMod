namespace = sfdoll_noel_event
#id标准写法为namespace的值加上编号

#诺耶露加入
#创建诺耶露特殊国家用于通讯，现在不创建只加flag
country_event = {
	id = sfdoll_noel_event.0
	hide_window = yes

	is_triggered_only = yes

	trigger = {	has_authority = auth_gf_sfdoll	}
	immediate = {
		# create_country = {
		# 	name = "name_noel_country"
		# 	type = country_type_sfdoll_event_leader 
		# 	flag = {
		# 		icon= {
		# 			category = "sfdoll_flags"
		# 			file = "sfdoll_ogas_flag.dds"
		# 		}
		# 		background= {
		# 			category = "backgrounds"
		# 			file = "sinus.dds"
		# 		}
		# 		colors={
		# 			"black"
		# 			"black"
		# 			"null"
		# 			"null"
		# 		}
		# 	}
		# 	effect = {
		# 		#设置target和flag
		# 		save_global_event_target_as = sfdoll_noel_country
		# 		set_country_flag = sfdoll_noel_country
		# 	}
		# }
		# event_target:sfdoll_noel_country = {
		# 	establish_communications_no_message = root
		# }
		save_global_event_target_as = sfdoll_noel_owner
		set_country_flag = sfdoll_noel_owner

		#创建一个物种，用于生成特殊领袖诺耶露
		create_species = {
			name = name_sfdoll_event_leader_species
			class = sf_a_doll
			immortal = yes
			effect = {
				set_species_flag = species_sfdoll_event_leader
				save_global_event_target_as = species_sfdoll_event_leader
			}
		}
	}
}

#和诺耶露通讯界面
country_event = {
	id = sfdoll_noel_event.1
	title = "sfdoll_noel_event_1_title"
	desc = "sfdoll_noel_event_1_a_desc"
	desc = "sfdoll_noel_event_1_c_desc"
	diplomatic = yes

	picture_event_data = {
		portrait = GFX_sfdoll_noel
		planet_background = root
		graphical_culture = root
		city_level = root
		room = root
	}	
	is_triggered_only = yes

	# trigger = {
	# 	AND = {
	# 		from = {  NOT = {has_country_flag = gray_country }	}
	# 		from = { has_country_flag = sfdoll_noel_country }
	# 		has_country_flag = sfdoll_noel_owner
	# 		NOT = { has_country_flag = contract_diplomacy_engaged }
	# 	}
	# }

	immediate = {
		set_country_flag = contract_diplomacy_engaged
	}
	after = {
		hidden_effect = { remove_country_flag = contract_diplomacy_engaged }
	}

	#选项，noel总督
	option = {
		name =  "noel_become_governor"
		allow = { 
			custom_tooltip ={
				fail_text ="noel_has_this_job_now"
				NOR = {
					AND = {
						exists = event_target:sfdoll_leader_noel
						event_target:sfdoll_leader_noel = { leader_class = governor }
					}			
				}
			}			 
		}
		hidden_effect = {
			effect_noel_become_governor = yes
			#country_event = { id = sfdoll_noel_event.2 }
		}
		response_text = "response_text_noel_become_governor"
	}

	# #选项，noel科学家
	option = {
		name =  "noel_become_scientist"
		allow = { 
			custom_tooltip ={
				fail_text ="noel_has_this_job_now"
				NOR = {
					AND = {
						exists = event_target:sfdoll_leader_noel
						event_target:sfdoll_leader_noel = { leader_class =scientist }
					}			
				}
			}			 
		}
		hidden_effect = {
			effect_noel_become_scientist = yes
			#country_event = { id = sfdoll_noel_event.3 }
		}
		response_text = "response_text_noel_become_scientist"
	}

	#选项，noel舰队司令
	option = {
		name =  "noel_become_admiral"
		allow = { 
			custom_tooltip ={
				fail_text ="noel_has_this_job_now"
				NOR = {
					AND = {
						exists = event_target:sfdoll_leader_noel
						event_target:sfdoll_leader_noel = { leader_class = admiral }
					}			
				}
			}			 
		}
		hidden_effect = {
			effect_noel_become_admiral = yes
			#country_event = { id = sfdoll_noel_event.4 }
		}
		response_text = "response_text_noel_become_admiral"
	}

	#选项，noel陆军司令
	option = {
		name =  "noel_become_general"
		allow = { 
			custom_tooltip ={
				fail_text ="noel_has_this_job_now"
				NOR = {
					AND = {
						exists = event_target:sfdoll_leader_noel
						event_target:sfdoll_leader_noel = { leader_class = general }
					}			
				}
			}			 
		}
		hidden_effect = {
			effect_noel_become_general = yes
			#country_event = { id = sfdoll_noel_event.5 }
		}
		response_text = "response_text_noel_become_general"
	}

	#退出
	option = {
		name =  "sfdoll_ump45_event_1_option"
		break = yes
	}

}


# 诺耶露加情况
country_event = {
	id = sfdoll_noel_event.6
	title = "sfdoll_noel_event_6_title"
	desc = "sfdoll_noel_event_6_desc"
	picture = GFX_evp_sfdoll_noel_sleep
	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		has_country_flag = sfdoll_empire
	}
	immediate = {
		country_event = {
			id = sfdoll_noel_event.0
		}
		
	}
	option = {
		name = sfdoll_noel_event.6_option
		add_resource = {
			unity = 1000
			physics_research = 4000
			society_research = 4000
			engineering_research = 4000
		}
	}
}
